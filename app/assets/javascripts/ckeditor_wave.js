'use strict';
var contentEditor;function initiateCkeditor(){Array.from(arguments).forEach(function(e){newEditor(e)})}function newEditor(e){if(null===(e=document.querySelector(e)))return!1;try{ClassicEditor.create(e,{image:{toolbar:["imageStyle:alignLeft","imageStyle:full","imageStyle:alignRight"],styles:["full","alignLeft","alignRight"]},extraPlugins:[cancelDropEvents],language:"ru"}).then(r=>{contentEditor=r,r.setData(e.value),r.plugins.get("FileRepository").createUploadAdapter=(e=>new UploadAdapter(e)),r.editing.view.document.on("change:isFocused",function(e,t,o){o?r.sourceElement.parentNode.classList.add("ckeditor-focused"):r.sourceElement.parentNode.classList.remove("ckeditor-focused")})}).catch(e=>{console.error(e)})}catch(e){console.log(e),console.log("Is ckeditor.js included?","https://ckeditor.com/ckeditor-5/download/")}}class UploadAdapter{constructor(e){this.loader=e}upload(){return server.onUploadProgress=(e=>{this.loader.uploadTotal=e.total,this.loader.uploaded=e.loaded}),server.upload(this.loader.file)}abort(){server.abortUpload()}}var server={upload:upload,destroy:destroy,onUploadProgress:null,abortUpload:abort,xhr:null};function cancelDropEvents(e){e.editing.view.document.on("drop",(e,r)=>{e.stop(),r.preventDefault()},{priority:"high"}),e.editing.view.document.on("dragover",(e,r)=>{e.stop(),r.preventDefault()},{priority:"high"})}function upload(e){return e.then(e=>new Promise((r,t)=>{server.xhr=new XMLHttpRequest;var o=new FormData;server.xhr.upload.onprogress=(e=>{e.lengthComputable&&server.onUploadProgress(e)}),server.xhr.onreadystatechange=(()=>{4===server.xhr.readyState&&200!==server.xhr.status&&t("Image upload failed"),4===server.xhr.readyState&&200===server.xhr.status&&(r({default:server.xhr.responseText}),console.log("Image upload successful"))}),o.set("ck_image",e),server.xhr.open("POST","/ckeditor_wave/ck_images"),server.xhr.send(o)}))}function destroy(e){var r=new XMLHttpRequest,t=new FormData;r.onreadystatechange=(()=>{4===r.readyState&&200!==r.status&&console.log("Image deletion failed"),4===r.readyState&&200===r.status&&server.onUploadProgress({loaded:0,total:0}),console.log(r.responseText)}),t.set("method","delete"),r.open("DELETE","/ckeditor_wave/ck_images/"+e),r.send(t)}function abort(){server.xhr&&server.xhr.abort()}function id(e){return e.src.match(/[^\/]*.$/g).toString().match(/[^.]*/)};